import{d as c,_ as p,o as n,c as a,b as e,t as r,h as d,f as i,F as g,w as u,v as b,i as y,e as W,j as k,r as w,g as C,n as v}from"./index.59440189.js";import{a as _}from"./sha256.e2b4c30e.js";import"./core.d00f0ac1.js";const O=c({name:"NonBlockingMain",props:{startCompute:{type:Boolean},difficulty:{type:Number,required:!0},blockData:{type:String,required:!0}},emits:["compute-done"],data(){return{time:0,startTime:0,pow:0,hash:""}},watch:{startCompute(t){t&&this.compute()}},methods:{compute(){this.pow=0,this.hash="",this.time=0;const t="0".repeat(this.difficulty),s=()=>{let l=_(this.blockData+this.pow++).toString();l.substring(0,this.difficulty)!==t?setTimeout(s,0):(this.time=performance.now()-this.startTime,this.hash=l,this.$emit("compute-done"))};this.startTime=performance.now(),s()}}}),P={key:0},D=i(" POW: "),V=e("br",null,null,-1),B={key:0},T=i(" Time taken in seconds: "),N=e("br",null,null,-1),S={key:1},F=i(" Final hash: "),q={style:{"word-wrap":"break-word"}};function M(t,s,l,h,m,f){return t.startCompute!==void 0?(n(),a("div",P,[D,e("code",null,r(t.pow),1),V,t.time?(n(),a("div",B,[T,e("code",null,r((t.time/1e3).toFixed(2)),1),N])):d("",!0),t.hash?(n(),a("div",S,[F,e("code",q,r(t.hash),1)])):d("",!0)])):d("",!0)}var U=p(O,[["render",M]]);function K(){return new Worker("/blockchain-demo/assets/pow-worker.4be41b3a.js",{type:"module"})}const z=c({name:"NonBlockingWorker",props:{startCompute:{type:Boolean},difficulty:{type:Number,required:!0},blockData:{type:String,required:!0}},emits:["compute-done"],data(){return{loading:!1,time:0,pow:0,hash:""}},watch:{startCompute(t){t&&this.compute()}},methods:{compute(){this.loading=!0,this.pow=0,this.hash="",this.time=0;const t=performance.now();if(window.Worker){const s=new K;s.postMessage({blockData:this.blockData,difficulty:this.difficulty}),s.onmessage=l=>{this.time=performance.now()-t,this.hash=l.data.hash,this.pow=l.data.pow,this.loading=!1,this.$emit("compute-done")}}else alert("Your browser doesn't support Web Workers!")}}}),E={key:0},j={key:0},H={key:1},R=i(" Time taken in seconds: "),Z=e("br",null,null,-1),L=i(" POW: "),I=e("br",null,null,-1),Y=i(" Final hash: "),A={style:{"word-wrap":"break-word"}};function G(t,s,l,h,m,f){return t.startCompute!==void 0?(n(),a("div",E,[t.loading?(n(),a("div",j,"Loading...")):(n(),a("div",H,[R,e("code",null,r((t.time/1e3).toFixed(2)),1),Z,L,e("code",null,r(t.pow),1),I,Y,e("code",A,r(t.hash),1)]))])):d("",!0)}var J=p(z,[["render",G]]);const Q=c({name:"Blocking",props:{startCompute:{type:Boolean},difficulty:{type:Number,required:!0},blockData:{type:String,required:!0}},emits:["compute-done"],data(){return{loading:!1,time:0,pow:0,hash:""}},watch:{startCompute(t){t&&this.compute()}},methods:{compute(){this.loading=!0,this.pow=0,this.hash="",this.time=0,setTimeout(()=>{const t="0".repeat(this.difficulty),s=performance.now();let l;do l=_(this.blockData+this.pow++).toString();while(l.substring(0,this.difficulty)!==t);this.hash=l,this.time=performance.now()-s,this.loading=!1,this.$emit("compute-done")},0)}}}),X=e("article",{class:"message is-danger"},[e("div",{class:"message-body"},[e("p",{class:"subtitle has-text-weight-bold"},"Warning"),i(" The "),e("i",null,"blocking option"),i(" selected will make this website unresponsive until the POW number is calculated, because the calculation will run on the main UI thread, freezing everything else until it is done! "),e("br"),e("br"),i(" Do not be alarmed if the website freezes. Simply close the tab if you would like to quit. ")])],-1),x={key:0},tt={key:0},et={key:1},st=i(" POW: "),ot=e("br",null,null,-1),it=i(" Time taken in seconds: "),nt=e("br",null,null,-1),lt=i(" Final hash: "),at={style:{"word-wrap":"break-word"}};function rt(t,s,l,h,m,f){return n(),a(g,null,[X,t.startCompute!==void 0?(n(),a("div",x,[t.loading?(n(),a("div",tt,"Loading...")):(n(),a("div",et,[st,e("code",null,r(t.pow),1),ot,it,e("code",null,r((t.time/1e3).toFixed(2)),1),nt,lt,e("code",at,r(t.hash),1)]))])):d("",!0)],64)}var dt=p(Q,[["render",rt]]);const $=()=>({difficulty:3,blockData:"",compute_type:"nb-main",startCompute:void 0}),ut=c({name:"ComputePOW",components:{"nb-main":U,"nb-worker":J,blocking:dt},data:$,watch:{compute_type(){this.startCompute=void 0}},methods:{compute(){this.startCompute=!0},reset(){Object.assign(this.$data,$())}}}),ct={class:"section"},pt={class:"columns is-multiline"},ht=e("div",{class:"column"},[e("p",{class:"title"},"Compute POW")],-1),mt={class:"column is-narrow"},ft={class:"box"},bt=i(" Set a difficulty level (How many starting zeros) "),yt=["disabled"],_t={class:"box"},vt=i(" Enter your data "),$t=["disabled"],kt={class:"box"},wt={class:"columns is-vcentered"},gt=e("div",{class:"column"},[e("p",{class:"title"},"Results")],-1),Wt={class:"column is-narrow"},Ct={class:"select is-success"},Ot=e("option",{value:"nb-main"}," Non Blocking (runs on Main Thread) ",-1),Pt=e("option",{value:"nb-worker"}," Non Blocking (runs on Web Worker) ",-1),Dt=e("option",{value:"blocking"},"Blocking (runs on Main Thread)",-1),Vt=[Ot,Pt,Dt],Bt={class:"column is-narrow"};function Tt(t,s,l,h,m,f){return n(),a("div",ct,[e("div",pt,[ht,e("div",mt,[e("button",{class:"button is-light is-danger is-fullwidth",onClick:s[0]||(s[0]=(...o)=>t.reset&&t.reset(...o))}," Reset ")])]),e("div",ft,[e("label",null,[bt,u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.difficulty=o),type:"number",class:"input",placeholder:"Difficulty level",disabled:t.startCompute,onKeypress:s[2]||(s[2]=y((...o)=>t.compute&&t.compute(...o),["enter"]))},null,40,yt),[[b,t.difficulty]])])]),e("div",_t,[e("label",null,[vt,u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.blockData=o),type:"text",class:"input",placeholder:"Whatever data you want in your block",disabled:t.startCompute,onKeypress:s[4]||(s[4]=y((...o)=>t.compute&&t.compute(...o),["enter"]))},null,40,$t),[[b,t.blockData]])])]),e("div",kt,[e("div",wt,[gt,e("div",Wt,[e("div",Ct,[u(e("select",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.compute_type=o)},Vt,512),[[W,t.compute_type]])])]),e("div",Bt,[e("button",{class:"button is-light is-success is-fullwidth",onClick:s[6]||(s[6]=(...o)=>t.compute&&t.compute(...o))}," Compute ")])]),(n(),k(w(t.compute_type),{class:"mt-5",difficulty:t.difficulty,blockData:t.blockData,startCompute:t.startCompute,onComputeDone:s[7]||(s[7]=o=>t.startCompute=!1)},null,8,["difficulty","blockData","startCompute"]))])])}var Nt=p(ut,[["render",Tt]]);const St=c({name:"Verify",data(){return{difficulty:3,blockData:"",pow:void 0,verified:void 0,hash:""}},methods:{verify(){if(!this.pow)return alert("POW number is not entered");const t="0".repeat(this.difficulty);this.hash=_(this.blockData+(this.pow-1)).toString(),this.verified=this.hash.substring(0,this.difficulty)===t}}}),Ft={class:"section"},qt=C('<div class="columns is-multiline"><div class="column"><p class="title">Verify POW</p></div><div class="column is-narrow"><button class="button is-light is-danger is-fullwidth">Reset</button></div></div>',1),Mt={class:"box"},Ut=i(" Set a difficulty level (How many starting zeros) "),Kt={class:"box"},zt=i(" Enter your data "),Et={class:"box"},jt=i(" Enter POW number to verify "),Ht={class:"box"},Rt={class:"columns is-vcentered"},Zt=e("div",{class:"column"},[e("p",{class:"subtitle"},"Verify")],-1),Lt={class:"column is-narrow"},It={key:0},Yt=i(" POW is "),At=e("br",null,null,-1),Gt=i(" Hash: ");function Jt(t,s,l,h,m,f){return n(),a("div",Ft,[qt,e("div",Mt,[e("label",null,[Ut,u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.difficulty=o),type:"number",class:"input",placeholder:"Difficulty level",onKeypress:s[1]||(s[1]=y((...o)=>t.verify&&t.verify(...o),["enter"]))},null,544),[[b,t.difficulty]])])]),e("div",Kt,[e("label",null,[zt,u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.blockData=o),type:"text",class:"input",placeholder:"Whatever data you want in your block",onKeypress:s[3]||(s[3]=y((...o)=>t.verify&&t.verify(...o),["enter"]))},null,544),[[b,t.blockData]])])]),e("div",Et,[e("label",null,[jt,u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.pow=o),type:"number",class:"input",placeholder:"POW number",onKeypress:s[5]||(s[5]=y((...o)=>t.verify&&t.verify(...o),["enter"]))},null,544),[[b,t.pow]])])]),e("div",Ht,[e("div",Rt,[Zt,e("div",Lt,[e("button",{class:"button is-light is-success",onClick:s[6]||(s[6]=(...o)=>t.verify&&t.verify(...o))}," Verify ")])]),t.verified!==void 0?(n(),a("div",It,[Yt,e("code",null,r(t.verified?"Correct":"Wrong"),1),At,Gt,e("code",null,r(t.hash),1)])):d("",!0)])])}var Qt=p(St,[["render",Jt]]);const Xt=c({name:"POW",components:{ComputePOW:Nt,VerifyPOW:Qt},data(){return{tab:"ComputePOW"}}}),xt={class:"navbar is-fixed-top"},te={class:"tabs is-centered"},ee=e("a",null,"Compute POW",-1),se=[ee],oe=e("a",null,"Verify POW",-1),ie=[oe];function ne(t,s,l,h,m,f){return n(),a("div",null,[e("nav",xt,[e("div",te,[e("ul",null,[e("li",{class:v({"is-active":t.tab==="ComputePOW"}),onClick:s[0]||(s[0]=o=>t.tab="ComputePOW")},se,2),e("li",{class:v({"is-active":t.tab==="VerifyPOW"}),onClick:s[1]||(s[1]=o=>t.tab="VerifyPOW")},ie,2)])])]),(n(),k(w(t.tab)))])}var de=p(Xt,[["render",ne]]);export{de as default};
