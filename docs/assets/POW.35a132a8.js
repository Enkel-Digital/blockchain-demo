import{d as c,_ as p,r as y,o as n,c as a,h as $,i as v,a as e,t as r,j as d,f as i,F as W,w as u,v as b,k as _,b as D,l as O,m as P,g as T,n as g}from"./index.ee2f944b.js";import{a as k}from"./sha256.4d35b2a5.js";import{_ as w}from"./CopyOnClick.8519784b.js";import"./_commonjsHelpers.dffb1198.js";import"./core.41ff40ea.js";const V=c({name:"NonBlockingMain",components:{CopyOnClick:w},props:{startCompute:{type:Boolean},difficulty:{type:Number,required:!0},blockData:{type:String,required:!0}},emits:["compute-done"],data(){return{time:0,startTime:0,pow:0,hash:""}},watch:{startCompute(t){t&&this.compute()}},methods:{compute(){this.pow=0,this.hash="",this.time=0;const t="0".repeat(this.difficulty),o=()=>{let l=k(this.blockData+this.pow++).toString();l.substring(0,this.difficulty)!==t?setTimeout(o,0):(this.time=performance.now()-this.startTime,this.hash=l,this.$emit("compute-done"))};this.startTime=performance.now(),o()}}}),S={key:0},B={key:0},N=i(" POW: "),F={key:1},q=i(" POW: "),M=e("br",null,null,-1),U={key:2},z=i(" Time taken in seconds: "),I=e("br",null,null,-1),E={key:3},K=i(" Final hash: "),j={class:"word-wrap"};function H(t,o,l,h,m,f){const s=y("CopyOnClick");return t.startCompute!==void 0?(n(),a("div",S,[t.startCompute===!1?(n(),a("span",B,[$(s,{showIcon:!0,textToCopy:t.pow.toString()},{default:v(()=>[N,e("code",null,r(t.pow),1)]),_:1},8,["textToCopy"])])):(n(),a("span",F,[q,e("code",null,r(t.pow),1)])),M,t.time?(n(),a("div",U,[z,e("code",null,r((t.time/1e3).toFixed(2)),1),I])):d("",!0),t.hash?(n(),a("div",E,[K,e("code",j,r(t.hash),1)])):d("",!0)])):d("",!0)}var R=p(V,[["render",H]]);function Z(){return new Worker("/blockchain-demo/assets/pow-worker.4be41b3a.js",{type:"module"})}const L=c({name:"NonBlockingWorker",components:{CopyOnClick:w},props:{startCompute:{type:Boolean},difficulty:{type:Number,required:!0},blockData:{type:String,required:!0}},emits:["compute-done"],data(){return{loading:!1,time:0,pow:0,hash:""}},watch:{startCompute(t){t&&this.compute()}},methods:{compute(){if(!window.Worker)return alert("Your browser doesn't support Web Workers!");this.loading=!0,this.pow=0,this.hash="",this.time=0;const t=performance.now(),o=new Z;o.postMessage({blockData:this.blockData,difficulty:this.difficulty}),o.onmessage=l=>{this.time=performance.now()-t,this.hash=l.data.hash,this.pow=l.data.pow,this.loading=!1,this.$emit("compute-done")}}}}),Y=e("article",{class:"message"},[e("div",{class:"message-body"},[e("p",{class:"subtitle has-text-weight-bold"},"Note"),i(" The "),e("i",null,"non blocking worker option"),i(" selected will not show any real time updates while the POW number is calculated, because the calculation will run on a seperate worker thread to speed things up, and communicating updates will negate the speed up. ")])],-1),A={key:0},G={key:0},J={key:1},Q=i(" Time taken in seconds: "),X=e("br",null,null,-1),x=i(" POW: "),tt=e("br",null,null,-1),et=i(" Final hash: "),ot={class:"word-wrap"};function st(t,o,l,h,m,f){const s=y("CopyOnClick");return n(),a(W,null,[Y,t.startCompute!==void 0?(n(),a("div",A,[t.loading?(n(),a("div",G,"Loading...")):(n(),a("div",J,[Q,e("code",null,r((t.time/1e3).toFixed(2)),1),X,$(s,{showIcon:!0,textToCopy:t.pow.toString()},{default:v(()=>[x,e("code",null,r(t.pow),1)]),_:1},8,["textToCopy"]),tt,et,e("code",ot,r(t.hash),1)]))])):d("",!0)],64)}var it=p(L,[["render",st]]);const nt=c({name:"Blocking",components:{CopyOnClick:w},props:{startCompute:{type:Boolean},difficulty:{type:Number,required:!0},blockData:{type:String,required:!0}},emits:["compute-done"],data(){return{loading:!1,time:0,pow:0,hash:""}},watch:{startCompute(t){t&&this.compute()}},methods:{compute(){this.loading=!0,this.pow=0,this.hash="",this.time=0,setTimeout(()=>{const t="0".repeat(this.difficulty),o=performance.now();let l;do l=k(this.blockData+this.pow++).toString();while(l.substring(0,this.difficulty)!==t);this.hash=l,this.time=performance.now()-o,this.loading=!1,this.$emit("compute-done")},0)}}}),at=e("article",{class:"message is-danger"},[e("div",{class:"message-body"},[e("p",{class:"subtitle has-text-weight-bold"},"Warning"),i(" The "),e("i",null,"blocking option"),i(" selected will make this website unresponsive until the POW number is calculated, because the calculation will run on the main UI thread, freezing everything else until it is done! "),e("br"),e("br"),i(" Do not be alarmed if the website freezes. Simply close the tab if you would like to quit. ")])],-1),lt={key:0},rt={key:0},dt={key:1},ut=i(" Time taken in seconds: "),ct=e("br",null,null,-1),pt=i(" POW: "),ht=e("br",null,null,-1),mt=i(" Final hash: "),ft={class:"word-wrap"};function bt(t,o,l,h,m,f){const s=y("CopyOnClick");return n(),a(W,null,[at,t.startCompute!==void 0?(n(),a("div",lt,[t.loading?(n(),a("div",rt,"Loading...")):(n(),a("div",dt,[ut,e("code",null,r((t.time/1e3).toFixed(2)),1),ct,$(s,{showIcon:!0,textToCopy:t.pow.toString()},{default:v(()=>[pt,e("code",null,r(t.pow),1)]),_:1},8,["textToCopy"]),ht,mt,e("code",ft,r(t.hash),1)]))])):d("",!0)],64)}var _t=p(nt,[["render",bt]]);const C=()=>({browserSupportWebWorker:Boolean(window.Worker),difficulty:3,blockData:"",compute_type:"nb-main",startCompute:void 0}),yt=c({name:"ComputePOW",components:{"nb-main":R,"nb-worker":it,blocking:_t},data:C,watch:{compute_type(){this.startCompute=void 0}},methods:{compute(){this.startCompute=!0},reset(){Object.assign(this.$data,C())}}}),$t={class:"section"},vt={class:"columns is-multiline"},kt=e("div",{class:"column"},[e("p",{class:"title"},"Compute Proof of Work")],-1),wt={class:"column is-narrow"},gt=["disabled"],Ct={class:"box"},Wt=i(" Set a difficulty level (How many starting zeros) "),Ot=e("br",null,null,-1),Pt=["disabled"],Dt={class:"mt-2 has-text-danger"},Tt={key:0},Vt={key:1},St={class:"box"},Bt=i(" Enter your data "),Nt=["disabled"],Ft={class:"box"},qt={class:"columns is-vcentered"},Mt=e("div",{class:"column"},[e("p",{class:"title"},"Results")],-1),Ut={class:"column is-narrow"},zt={class:"select is-success"},It=["disabled"],Et=e("option",{value:"nb-main"}," Non Blocking (runs on Main Thread) ",-1),Kt={key:0,value:"nb-worker"},jt=e("option",{value:"blocking"},"Blocking (runs on Main Thread)",-1),Ht={class:"column is-narrow"};function Rt(t,o,l,h,m,f){return n(),a("div",$t,[e("div",vt,[kt,e("div",wt,[e("button",{class:"button is-light is-danger is-fullwidth",disabled:t.startCompute,onClick:o[0]||(o[0]=(...s)=>t.reset&&t.reset(...s))}," Reset ",8,gt)])]),e("div",Ct,[e("label",null,[Wt,Ot,i(" Chance of getting it correct per guess: 1 in "+r(Intl.NumberFormat().format(16**t.difficulty))+" ",1),u(e("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>t.difficulty=s),type:"number",class:"input",placeholder:"Difficulty level",disabled:t.startCompute,min:"1",onKeypress:o[2]||(o[2]=_((...s)=>t.compute&&t.compute(...s),["enter"]))},null,40,Pt),[[b,t.difficulty]])]),e("div",Dt,[t.difficulty>5?(n(),a("span",Tt," Danger! This might take very long to compute! ")):t.difficulty>4?(n(),a("span",Vt," Warning! This might take some time to compute. ")):d("",!0)])]),e("div",St,[e("label",null,[Bt,u(e("textarea",{"onUpdate:modelValue":o[3]||(o[3]=s=>t.blockData=s),class:"textarea",placeholder:"Whatever data you want in your block",disabled:t.startCompute},null,8,Nt),[[b,t.blockData]])])]),e("div",Ft,[e("div",qt,[Mt,e("div",Ut,[e("div",zt,[u(e("select",{"onUpdate:modelValue":o[4]||(o[4]=s=>t.compute_type=s),disabled:t.startCompute},[Et,t.browserSupportWebWorker?(n(),a("option",Kt," Non Blocking (runs on Web Worker) ")):d("",!0),jt],8,It),[[D,t.compute_type]])])]),e("div",Ht,[e("button",{class:"button is-light is-success is-fullwidth",onClick:o[5]||(o[5]=(...s)=>t.compute&&t.compute(...s))}," Compute ")])]),(n(),O(P(t.compute_type),{difficulty:t.difficulty,blockData:t.blockData,startCompute:t.startCompute,onComputeDone:o[6]||(o[6]=s=>t.startCompute=!1)},null,8,["difficulty","blockData","startCompute"]))])])}var Zt=p(yt,[["render",Rt]]);const Lt=c({name:"Verify",data(){return{difficulty:3,blockData:"",pow:void 0,verified:void 0,hash:""}},methods:{verify(){if(!this.pow)return alert("POW number is not entered");const t="0".repeat(this.difficulty);this.hash=k(this.blockData+(this.pow-1)).toString(),this.verified=this.hash.substring(0,this.difficulty)===t}}}),Yt={class:"section"},At=T('<div class="columns is-multiline"><div class="column"><p class="title">Verify Proof of Work</p></div><div class="column is-narrow"><button class="button is-light is-danger is-fullwidth">Reset</button></div></div>',1),Gt={class:"box"},Jt=i(" Set a difficulty level (How many starting zeros) "),Qt={class:"box"},Xt=i(" Enter your data "),xt={class:"box"},te=i(" Enter POW number to verify "),ee={class:"box"},oe={class:"columns is-vcentered"},se=e("div",{class:"column"},[e("p",{class:"subtitle"},"Verify")],-1),ie={class:"column is-narrow"},ne={key:0},ae=i(" POW is "),le=e("br",null,null,-1),re=i(" Hash: ");function de(t,o,l,h,m,f){return n(),a("div",Yt,[At,e("div",Gt,[e("label",null,[Jt,u(e("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>t.difficulty=s),type:"number",class:"input",placeholder:"Difficulty level",min:"1",onKeypress:o[1]||(o[1]=_((...s)=>t.verify&&t.verify(...s),["enter"]))},null,544),[[b,t.difficulty]])])]),e("div",Qt,[e("label",null,[Xt,u(e("textarea",{"onUpdate:modelValue":o[2]||(o[2]=s=>t.blockData=s),class:"textarea",placeholder:"Whatever data you want in your block"},null,512),[[b,t.blockData]])])]),e("div",xt,[e("label",null,[te,u(e("input",{"onUpdate:modelValue":o[3]||(o[3]=s=>t.pow=s),type:"number",class:"input",placeholder:"POW number",onKeypress:o[4]||(o[4]=_((...s)=>t.verify&&t.verify(...s),["enter"]))},null,544),[[b,t.pow]])])]),e("div",ee,[e("div",oe,[se,e("div",ie,[e("button",{class:"button is-light is-success",onClick:o[5]||(o[5]=(...s)=>t.verify&&t.verify(...s))}," Verify ")])]),t.verified!==void 0?(n(),a("div",ne,[ae,e("code",null,r(t.verified?"Correct":"Wrong"),1),le,re,e("code",null,r(t.hash),1)])):d("",!0)])])}var ue=p(Lt,[["render",de]]);const ce=c({name:"POW",components:{ComputePOW:Zt,VerifyPOW:ue},data(){return{tab:"ComputePOW"}}}),pe={class:"section py-0"},he={class:"columns has-text-centered"},me={class:"column is-half"},fe={class:"column is-half"};function be(t,o,l,h,m,f){return n(),a("div",null,[e("div",pe,[e("div",he,[e("div",me,[e("button",{class:g(["button is-light is-fullwidth",{"is-success":t.tab==="ComputePOW"}]),onClick:o[0]||(o[0]=s=>t.tab="ComputePOW")}," Compute POW ",2)]),e("div",fe,[e("button",{class:g(["button is-light is-fullwidth",{"is-success":t.tab==="VerifyPOW"}]),onClick:o[1]||(o[1]=s=>t.tab="VerifyPOW")}," Verify POW ",2)])])]),(n(),O(P(t.tab)))])}var we=p(ce,[["render",be]]);export{we as default};
